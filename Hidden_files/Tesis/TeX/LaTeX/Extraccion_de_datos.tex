\chapter{Extracción de datos}

La fuente de información de donde se obtuvieron los datos utilizados son las páginas de los horarios de la Facultad de Ciencias de la UNAM. Cada página contiene toda la posible información de los grupos de una materia, un semestre y una carrera. Sólo se toma en cuenta la información de las carreras del Departamento de Matemáticas, las cuales son: Actuaría, Ciencias de la Computación, Matemáticas y Matemáticas Aplicadas.

La información que se puede extraer de las páginas mencionadas es: nombre de profesores, nombre de ayudantes, salón, horario, plan, carrera, año y tipo de semestre (ej. \textit{2018-2} implica que es el semestre par del 2018), materia, semestre de la materia. (ej. \textit{Quinto Semestre}), tipo de materia (obligatoria u optativa), fecha, horario y salón de exámenes finales. En la figura \ref{pagFC} se muestra un ejemplo de dichas páginas.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.6]{Fuente_de_info} %width=\textwidth
%\url{http://www.fciencias.unam.mx/docencia/horarios/20201/217/607} %%URL de la imagen
\caption{\textit{Página de horarios de la FC}}\label{pagFC}
\end{figure}

\section{Extracción de información con la aplicación SelectorGadget}

Para extraer los datos de las páginas de la FC se utilizó una aplicación de Google Chrome llamada \textit{SelectorGadget}, la cual permite seleccionar la información deseada y ésta arroja una sección del código CSS de la página web el cual se introduce en R para que se descargue la información deseada.

En la figura \ref{appSelectorGadget} se puede ver un ejemplo del funcionamiento de la aplicación. El ícono de la aplicación es una lupa, el cual se encuentra señalado por la flecha roja. Una vez presionado el ícono se seleccionó el nombre de algún profesor (en color verde), la aplicación automáticamente seleccionó todas las entradas que coindicidían (en color amarillo), pero debido a que se seleccionó más información de la deseada entonces se dió click sobre un salón y el nombre de un ayudante (en color rojo). En el cuadro de texto, la aplicación arroja la sección del código CSS correspondiente, junto al código mencionado, se puede observar que se seleccionaron 15 entradas correspondientes a los nombres de los profesores de la materia de Probabilidad I.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.65]{SelectorGadget} %width=\textwidth
%\url{http://www.fciencias.unam.mx/docencia/horarios/20181/2017/625} %%URL de la imagen
\caption{\textit{Aplicación SelectorGadget}}\label{appSelectorGadget}
\end{figure}

\section{Estructura de las páginas web}

El estar haciendo la búsqueda de información, de manera manual, de los horarios para cada materia, cada carrera y cada uno de sus planes de estudio, requiere de mucho tiempo de trabajo, por lo que decidimos buscar la existencia de alguna estructura en las páginas web de los horarios de la FC para poder realizar la búsqueda de la información de una manera automática y mucho más rápida. Se observó que la estructura que siguen todas las páginas de internet es la siguiente:

\begin{center}
\textit{\textbf{http://www.fciencias.unam.mx/docencia/horarios/a/b/c}}
\end{center}

Se tiene una raíz común para todas las páginas y al final se tienen tres números los cuales representan:

\begin{itemize}
\item[ ] a = año y tipo de semestre (par o impar), $a \in \{$20081, 20082, 20091, 20092, 20101, 20102, $\ldots, 20201\}$

\item[ ] b = clave de plan de estudio

\item[ ] c = número de materia, $c \in \{1,1000\}$.
\end{itemize}

Para la realización de este trabajo se tomaron en cuenta sólo los planes de estudio vigentes al día de hoy, los cuales son todos los planes mostrados en la tabla \ref{PlanesEstudio}, salvo el plan 1972 de Actuaría. Dicha tabla muestra los planes de estudio de cada carrera con su clave correspondiente.

\begin{table}[h]
\centering
\begin{tabular}{|c|c|}
 \hline 
  PLAN & CLAVE \\ 
 \hline 
 \multicolumn{2}{|c|}{Actuaría} \\ 
 \hline 
 1972 & 214 \\ 
 \hline 
 2000 & 119 \\ 
 \hline 
 2006 & 1176 \\ 
 \hline 
 2015 & 2017 \\ 
 \hline 
 \multicolumn{2}{|c|}{Ciencias de la Computación} \\ 
 \hline 
 1994 & 218 \\ 
 \hline 
 2013 & 1556 \\ 
 \hline 
 \multicolumn{2}{|c|}{Matemáticas} \\ 
 \hline 
 1983 & 217 \\ 
 \hline 
 \multicolumn{2}{|c|}{Matemáticas Aplicadas} \\ 
 \hline 
 2017 & 2055 \\ 
 \hline 
 \end{tabular}
\caption{\textit{Planes de estudio por carrera con clave}}\label{PlanesEstudio}
\end{table}

Una vez identificada la estructura de las páginas web se pudo realizar la búsqueda de información de manera automatizada. Se decidió que $c \in \{1,2,3, \ldots, 10 000\}$.

Se hizo una función que genera una matriz llamada \textit{mat\_posibles\_url}, en la cual se guardan, entre otros datos, las URL's de las páginas de los horarios de la FC. La función sólo guarda las URL's que si existen.

Al obtener la matriz, se observó que el valor máximo que toma $c$ es 991, por lo que se redujo su conjunto de posibles valores y se definió $c \in \{1, \ldots, 1 000\}$.

Las categorías de las columnas de la matriz \verb+mat_posibles_url+ se definen en la tabla \ref{matPosiblesURL}.

\dfNmatrizChica %%Tabla con la información de la matriz chica


\section{Tipos de grupos de las páginas web de la Facultad de Ciencias} \label{TiposDeGpos}

Al inicio se encontraron tres tipos de grupos dentro de las páginas de horarios de la FC, cada uno con información similar, pero se hizo la separación de acuerdo a sus diferencias.

En este trabajo se considera como semestre actual al semestre $2020-1$.

En todos los grupos se puede encontrar la información del nombre de profesor, nombre de ayudante, salón, horario y el número de alumnos inscritos en el grupo.

\begin{enumerate}
\item[a)] En el grupo \textbf{A} se tienen las páginas correspondientes al semestre actual. Este grupo tiene la información del número de lugares diponibles por salón, pero no contiene la información de los exámenes finales.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.8]{GrupoA} %width=\textwidth
\caption{\textit{Tipo de grupo A}}
%\url{http://www.fciencias.unam.mx/docencia/horarios/20201/2017/1707}
\end{figure}


\item[b)] En el grupo \textbf{B} se tienen las páginas correspondientes a semestres entre el $2018-2$ y el semestre anterior al actual, con respecto al año en curso. En este tipo de grupos se tiene información del número de lugares disponibles por salón y la información de los exámenes finales.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.8]{GrupoB} %width=\textwidth
\caption{\textit{Tipo de grupo B}}
%\url{http://www.fciencias.unam.mx/docencia/horarios/20182/217/625}
\end{figure}

\item[c)] En el grupo \textbf{C} se tienen las páginas correspondientes a semestres anteriores al $2018-1$, incluyéndolo, este tipo de grupos tiene información de los exámenes finales, pero no contiene la información del número de lugares disponibles por salón.
\end{enumerate}

\begin{figure}[H]
\centering
\includegraphics[scale = 0.8]{GrupoC} %width=\textwidth
\caption{\textit{Tipo de grupo C}}
%\url{http://www.fciencias.unam.mx/docencia/horarios/20181/1556/399}
\end{figure}

\section{Limpieza de base de datos}

Se puede encontrar que, en general, cuando uno realiza la limpieza de datos se hace el 80\% del análisis de los datos, ya que es en ese momento en donde se encuentran los diferentes problemas que se pueden presentar, como posibles errores en los datos, información incompleta, o valores poco comunes de acuerdo al comportamiento observado.

En nuestro caso al limpiar los datos nos encontramos con problemas de falta de información, problemas de información repetida, problemas al extraer información, entre otros, cada uno de éstos se desglosan en las siguientes secciones.

\input{ED_falta_de_info} %%Subsección %%To include subfiles in to a subfiles use \input{name_of_file}
\input{ED_info_repetida} %%Subsección
\input{ED_otros_problemas_extraer_info} %%Subsección

\section{Matrices de datos}

Una vez que se realizó el proceso de la limpieza de los datos obtenidos, éstos se guardaron, por semestre, en matrices llamadas \textit{m\_grande}, los nombres de sus columnas con su respectiva explicación y posibles valores, se muestran en la siguiente tabla:

\dfNmatrizGrande %%Tabla con la información de la matriz grande

La columna \textit{Cambios}, va a guardar todos los cambios que han ``sobrevivido'' esos grupos. El significado de los números que pueden aparecer en esa columna se explican a continuación:

\begin{enumerate}
\item[(1)] Grupos revisados a mano.

\item[(2)] Se anotaron los días en los que se imparte la materia, en la columna \textit{Horario}, por ejemplo cuando había conflicto debido a que el profesor impartía más de una materia a la misma hora, al revisar el caso se encontró que los días en los que se impartía la clase era distinto.

\item[(3)] Se eliminaron los grupos repetidos.

\item[(4)] Páginas que no tienen información del salón.
\end{enumerate}
