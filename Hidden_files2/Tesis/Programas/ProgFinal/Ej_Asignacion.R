##########################################################################
#' En este programa se encuentran los ejemplos de las diferentes funciones
#' que se encuentran en el archivo "Fn_Asignación.R"
##########################################################################

#Source ------------------------------------------------------------------
#Se utiliza el comando source() para poder cargar todas las funciones que
#se encuentran en el archivo Fn_Asignación.
rm(list=ls())  # Borra variables
cat("\014") # Borra consola
#Se establece el directorio en el que se va a trabajar
setwd("C:/Users/miri_/Dropbox/Carpeta compartida MIri/Faculty_schedule_simulation/Hidden_files/Tesis/Programas/ProgFinal")
source("Fn_Asignacion.R")

## Nombres para pruebas:
# profesor <- "Margarita Elvira Chávez Cano"
# materia <- "Estadística I"
# materia <- "Inferencia Estadística"
# materia <- "Estadística II"
# materia <- "Modelos no Paramétricos y de Regresión"
# materia <- "Estadística III"
# materia <- "Modelos de Supervivencia y de Series de Tiempo"
# 
# profesor <- "Claudia Orquídea López Soto"
# materia <- "Investigación de Operaciones"

# "Estadística I" - "Inferencia Estadística"
# "Estadística II" - "Modelos no Paramétricos y de Regresión"
# "Estadística III" - "Modelos de Supervivencia y de Series de Tiempo"

# gen_m_grande_total ------------------------------------------------------
#' Title gen_m_grande_total: Función que genera la matriz "m_grande_total"
#' para un intervalo dado.
#'
# param$sem_ini = 20131##Inicio de información real
# param$sem_fin = 20201##Fin de información real
# param$sem_sig = 20202##Semestre de simulación
# param$sem_totales <- (20081:param$sem_sig)[(20081:param$sem_sig)%% 10>0
#                                            &(20081:param$sem_sig)%% 10<3]
# param$Semestres = (param$sem_ini:param$sem_fin)[(param$sem_ini:param$sem_fin)
#                                                 %% 10>0 &(param$sem_ini:param$sem_fin) %% 10<3]
# param$nombre_sem = as.character(param$Semestres)
# param$n_semestres_anteriores = length(param$Semestres)

param$sem_ini = 20151##Inicio de información real
param$sem_fin = 20201##Fin de información real
param$sem_sig = 20202##Semestre de simulación
param$sem_totales <- (20081:param$sem_sig)[(20081:param$sem_sig)%% 10>0
                                           &(20081:param$sem_sig)%% 10<3]
param$Semestres = (param$sem_ini:param$sem_fin)[(param$sem_ini:param$sem_fin)
                                                %% 10>0 &(param$sem_ini:param$sem_fin) %% 10<3]
param$nombre_sem = as.character(param$Semestres)
param$n_semestres_anteriores = length(param$Semestres)

# param$sem_ini = 20081##Inicio de información real
# param$sem_fin = 20192##Fin de información real
# param$sem_sig = 20201##Semestre de simulación
# param$sem_totales <- (20081:param$sem_sig)[(20081:param$sem_sig)%% 10>0
#                                            &(20081:param$sem_sig)%% 10<3]
# param$Semestres = (param$sem_ini:param$sem_fin)[(param$sem_ini:param$sem_fin)
#                                                 %% 10>0 &(param$sem_ini:param$sem_fin) %% 10<3]
# param$nombre_sem = as.character(param$Semestres)
# param$n_semestres_anteriores = length(param$Semestres)

vec_excepciones <- "Inglés"
m_grande_total <- gen_m_grande_total(vec_excepciones,param)
View(m_grande_total)

## Todos los semestres
semestres <- param$sem_totales
for(d in length(semestres):11){
  n_semestres_anteriores <- d-1
  param$Semestres = semestres[1:n_semestres_anteriores]
  param$sem_fin = semestres[d-1]
  param$sem_sig = semestres[d]
  m_grande_total <- gen_m_grande_total(vec_excepciones,param)
  # View(m_grande_total)
}


# gen_vec_nom_materias_total ----------------------------------------------
#' Title gen_vec_nom_materias_total: Función que carga la matriz
#' "m_grande_total" de los semestres 2008-1 a 2020-1 de la cual se va
#' obtiene la lista de nombres de las materias sin repetición, conservando
#' los nombres más recientes de las materias.
#' 
vec_nom_materias_total <- gen_vec_nom_materias_total()
length(vec_nom_materias_total) ## 333
View(vec_nom_materias_total)


# arroja_ind_col_SG -------------------------------------------------------
#' Función que recibe el nombre de la columna que se busca y devuelve el
#' número de columna en "mat_simula_grupos" con ese nombre.
#'
arroja_ind_col_SG("Materia") ##1
arroja_ind_col_SG("Horario") ##2
arroja_ind_col_SG("Grupos_Simulados") ##3
arroja_ind_col_SG("Alumnos_Simulados_Totales") ##4
arroja_ind_col_SG("col_1er_grupo") ##5
arroja_ind_col_SG("col_ult_grupo") ##24


# arroja_ind_col_RG -------------------------------------------------------
#' Title arroja_ind_col_RG: Función que recibe el nombre de la columna que
#' se busca y devuelve el número de columna en "mat_real_grupos" con ese
#' nombre.
#'
#' @param nombre_col: Nombre de la columna de "mat_real_grupos" de la que
#' se busca conocer la columna en la que se encuentra en dicha matriz.
#' @example nombre_col <- "Alumnos_Reales_Totales"
#'
#' @return num_col: Número de columna en "mat_real_grupos" con nombre
#' "nombre_col".
#' @example num_col <- 4
#'
arroja_ind_col_RG("Materia") ##1
arroja_ind_col_RG("Horario") ##2
arroja_ind_col_RG("Grupos_Reales") ##3
arroja_ind_col_RG("Alumnos_Reales_Totales") ##4
arroja_ind_col_RG("col_1er_grupo") ##5
arroja_ind_col_RG("col_ult_grupo") ##24


# arroja_ind_col_MG -------------------------------------------------------
#' Title arroja_ind_col_MG: Función que recibe el nombre de la columna que
#' se busca y devuelve el número de columna en "m_grande" con ese nombre.
#'
num_col_Materia <- arroja_ind_col_MG("Materia")##1
num_col_Profesor <- arroja_ind_col_MG("Profesor")##2
num_col_Horario <- arroja_ind_col_MG("Horario")##3
num_col_horario_num <- arroja_ind_col_MG("horario_num")##4
num_col_Lugares <- arroja_ind_col_MG("Lugares")##5
num_col_Alumnos <- arroja_ind_col_MG("Alumnos")##6
num_col_Salon <- arroja_ind_col_MG("Salon")##7
num_col_Grupo <- arroja_ind_col_MG("Grupo")##8
num_col_Carrera <- arroja_ind_col_MG("Carrera")##9
num_col_Plan <- arroja_ind_col_MG("Plan")##10
num_col_Semestre <- arroja_ind_col_MG("Semestre")##11
num_col_Cambios <- arroja_ind_col_MG("Cambios")##12
num_col_Turno <- arroja_ind_col_MG("Turno")##13
num_col_Sem_de_mat <- arroja_ind_col_MG("Semestre_de_materia")##14
num_col_url <- arroja_ind_col_MG("url")##15
num_col_Act2000 <- arroja_ind_col_MG("Act2000")##16
num_col_Act2006 <- arroja_ind_col_MG("Act2006")##17
num_col_Act2015 <- arroja_ind_col_MG("Act2015")##18
num_col_CdC1994 <- arroja_ind_col_MG("CdC1994")##19
num_col_CdC2013 <- arroja_ind_col_MG("CdC2013")##20
num_col_Mat1983 <- arroja_ind_col_MG("Mat1983")##21
num_col_MAp2017 <- arroja_ind_col_MG("MAp2017")##22
num_col_NomMat_Act2000 <- arroja_ind_col_MG("NomMat_Act2000")##23
num_col_NomMat_Act2006 <- arroja_ind_col_MG("NomMat_Act2006")##24
num_col_NomMat_Act2015 <- arroja_ind_col_MG("NomMat_Act2015")##25
num_col_NomMat_CdC1994 <- arroja_ind_col_MG("NomMat_CdC1994")##26
num_col_NomMat_CdC2013 <- arroja_ind_col_MG("NomMat_CdC2013")##27
num_col_NomMat_Mat1983 <- arroja_ind_col_MG("NomMat_Mat1983")##28
num_col_NomMat_MAp2017 <- arroja_ind_col_MG("NomMat_MAp2017")##29
num_col_URL_Act2000 <- arroja_ind_col_MG("URL_Act2000")##30
num_col_URL_Act2006 <- arroja_ind_col_MG("URL_Act2006")##31
num_col_URL_Act2015 <- arroja_ind_col_MG("URL_Act2015")##32
num_col_URL_CdC1994 <- arroja_ind_col_MG("URL_CdC1994")##33
num_col_URL_CdC2013 <- arroja_ind_col_MG("URL_CdC2013")##34
num_col_URL_Mat1983 <- arroja_ind_col_MG("URL_Mat1983")##35
num_col_URL_MAp2017 <- arroja_ind_col_MG("URL_MAp2017")##36
num_col_NumMateria <- arroja_ind_col_MG("Num_materia")##37


# checa_ind_materia -------------------------------------------------------
#' Title checa_ind_materia: Función que revisa en qué índices de la matriz
#' "m_grande_total" o "m_grande" coincide "materia" con los nombres que se
#' encuentran en las columnas:
#'  Materia
#'  NomMat_Act2000
#'  NomMat_Act2006
#'  NomMat_Act2015
#'  NomMat_CdC1994
#'	NomMat_CdC2013
#'  NomMat_Mat1983
#'  NomMat_MAp2017
#' Arroja un vector con los índices en los que hay coincidencia para que
#' se cree la matriz con la información necesaria.
#'
load("C:/Users/miri_/Dropbox/Carpeta compartida MIri/Programas/Prog V05/m_grande_total_20081_20201_V01.RData")
View(m_grande_total)
materia <- "Modelos no Paramétricos y de Regresión"
checa_ind_materia(materia,m_grande_total)


# arroja_num_materia ------------------------------------------------
#' Title arroja_num_materia: Función que recibe el nombre de la
#' materia que se busca y devuelve el número de materia en "vec_nom_materias"
#' con ese nombre.
#'
materia <- "Estadística I"
(num_materia <- arroja_num_materia(materia))
materia <- "Estadística IV"
arroja_num_materia(materia)
arroja_num_materia("Matemáticas para las Ciencias Aplicadas I")
arroja_num_materia("Matemáticas Actuariales del Seguro de Personas I")#85
arroja_num_materia("Matemáticas Actuariales del Seguro de Personas II")#80
arroja_num_materia("Matemáticas Actuariales para Seguro de Daños, Fianzas y Reaseguro")#80
arroja_num_materia("Teoría de los Conjuntos I")
arroja_num_materia("Teoría del Seguro")#59
arroja_num_materia("Teoría del Riesgo")#86
arroja_num_materia("Demografía")
arroja_num_materia("Demografía I")
arroja_num_materia("Historia de las Matemáticas I")
arroja_num_materia("Procesos Estocásticos I")
arroja_num_materia("Procesos Estocásticos II")#123
arroja_num_materia("Temas Selectos de Economía")
arroja_num_materia("Seminario de Apoyo a la Titulación en Actuaría A")
arroja_num_materia("Geometría Proyectiva")
arroja_num_materia("Teoría de los Conjuntos II")
arroja_num_materia("Topología III")
arroja_num_materia("Álgebra Superior I")
arroja_num_materia("Álgebra Moderna I")#20
arroja_num_materia("Probabilidad I")
arroja_num_materia("Seminario de Estadística I")#143
arroja_num_materia("Cálculo Diferencial e Integral II")#48
arroja_num_materia("Cálculo Diferencial e Integral III")#49
arroja_num_materia("Economía")#84
arroja_num_materia("Inglés III")#174
arroja_num_materia("Inglés VI")#181
arroja_num_materia("Topología III")#102
arroja_num_materia("Lógica Matemática I")#61
arroja_num_materia("Administración Actuarial del Riesgo")#1
arroja_num_materia("Seminario de Apoyo a la Titulación en Matemáticas")#187
arroja_num_materia("Mecánica Analítica")#13
arroja_num_materia("Seminario de Geometría A")#70
arroja_num_materia("Seminario de Topología A")#34
arroja_num_materia("Análisis Matemático III")#40
arroja_num_materia("Estructuras Discretas")#65


# arroja_nom_correcto -----------------------------------------------------
#' Title arroja_nom_correcto: Función que arroja un vector con el nombre
#' correcto de la materia ingresada y su número de materia.
#'
nom_materia <- "Administración"
vec_info_nombre <- arroja_nom_correcto(nom_materia)
nom_materia <- "/Principios de Computación Distribuida/Computación Concurrente"
vec_info_nombre <- arroja_nom_correcto(nom_materia)

nom_materia <- "Estadística I"
vec_info_nombre <- arroja_nom_correcto(nom_materia)
nom_materia <- "Inferencia Estadística"
vec_info_nombre <- arroja_nom_correcto(nom_materia)

arroja_nom_correcto("Matemáticas para las Ciencias Aplicadas")


# agrega_nom_1_materia_en_vec ---------------------------------------------
#' Title agrega_nom_1_materia_en_vec: Función que recibe como parámetros el
#' nombre de una materia y el vector con los nombres de las materias y
#' guarda la materia en caso de dar la opción de "SI". También imprime una
#' lista con los diferentes nombres que pudiera tener "materia" en
#' "vec_nom_materias_total"
#' Por ejemplo "Estadística III" y "Modelos de Supervivencia y de Series
#' de Tiempo".
materia <- "Taller de Redacción"
vec_nom_materias_total <- param$vec_nom_materias_total
agrega_nom_1_materia_en_vec(materia,vec_nom_materias_total)

load(file = "vec_nom_materias_total.RData")
param$vec_nom_materias_total = vec_nom_materias_total
vec_nom_materias_total <- param$vec_nom_materias_total
materia <- "Solución Numérica de Ecuaciones Diferenciales Ordinarias"
agrega_nom_1_materia_en_vec(materia,vec_nom_materias_total)

load(file = "vec_nom_materias_total.RData")
param$vec_nom_materias_total = vec_nom_materias_total
vec_nom_materias_total <- param$vec_nom_materias_total


# actualiza_col_num_materia -----------------------------------------------
#' Title actualiza_col_num_materia: Función que actualiza las matrices
#' "m_grande" con el nombre correcto para las materias y también actualiza
#' el número de materia en caso de ser necesario.
#'
actualiza_col_num_materia(param)



# carga_info_prof_tiempo_completo -----------------------------------------
#' Title carga_info_prof_tiempo_completo: Función que extrae los nombres de
#' los profesores de tiempo completo del Departamento de Matemáticas.
#'
vec_prof_TC <- carga_info_prof_tiempo_completo()
length(vec_prof_TC)##94

# gen_mat_nom_prof_total --------------------------------------------------
#' Title gen_mat_nom_prof_total: Función que carga la matriz
#' "m_grande_total" de los semestres 2015-1 a 2020-1 de la cual se va
#' obtiene la lista de nombres de los profesores sin repetición. La matriz
#' "mat_nom_prof_total" tiene 2 columnas, en la primera se tiene el nombre
#' de los profesores y en la segunda se tiene un 1 si el profesor es de
#' tiempo completo y 0 si no.
#'
mat_nom_prof_total <- gen_mat_nom_prof_total()
sum(as.numeric(mat_nom_prof_total[,2]))#94
dim(mat_nom_prof_total)#1387 2
View(mat_nom_prof_total)


# gen_mat_materias_x_carrera ----------------------------------------------
#' Title gen_mat_materias_x_carrera: Función que genera la lista con las
#' matrices que tienen los nombres de las materias de cada carrera y el
#' número de materia para cada materia.
#'

gen_mat_materias_x_carrera(param)
load("lista_mat_materias_x_carrera.RData")
mat_materias_act <- lista_mat_materias_x_carrera[[1]]
View(mat_materias_act)
mat_materias_CdC <- lista_mat_materias_x_carrera[[2]]
View(mat_materias_CdC)
mat_materias_mate <- lista_mat_materias_x_carrera[[3]]
View(mat_materias_mate)
mat_materias_mateAp <- lista_mat_materias_x_carrera[[4]]
View(mat_materias_mateAp)


# gen_mat_alumnos_corregidos ----------------------------------------------
#' Title gen_mat_alumnos_corregidos: Función que regresa la matriz 
#' "mat_alumnos_corregidos" de 15 renglones (horas) y k+s-1 columnas, la
#' cual tiene el número total de alumnos por hora y por semestre. Se suma
#' el número de alumnos en los semestres repetidos por cada hora. Hay
#' ceros en los semestres y horas en donde no hay información.
#'
param_sim$vec_sem_sig <- 20202
# param_sim$vec_sem_sig <- c(20182,20191,20192,20201)
# param_sim$Materias = "Estadística III" ##Puede ser una o más materias
param_sim$Materias = "Modelos de Supervivencia y de Series de Tiempo"
vec_s_sem_k_info <- gen_vec_s_sem_k_info(param_sim$vec_sem_sig,
                                         param_sim$k_sem_ant,param)
param_sim$m_filtrada <- gen_mat_m_filtrada(param,param_sim)
mat_alumnos_corregidos <- gen_mat_alumnos_corregidos(vec_s_sem_k_info,
                                                     param,param_sim)
mat_alumnos_corregidos


# simula_alumnos ----------------------------------------------------------
#' Title simula_alumnos: Función que genera el vector "vec_sim_1_sem", el
#' cual tiene la simulación de un semestre.
#'
(vec_sim_1_sem <- simula_alumnos(mat_alumnos_corregidos,param))


# gen_mat_demanda_alumnos -------------------------------------------------
#' Title gen_mat_demanda_alumnos: Función que genera la matriz
#' "mat_demanda_alumnos" con 15 renglones (horas) y 333 columnas (materias).
#' En la entrada (i,j) se tiene el número de alumnos simulados para la hora
#' i, y la materia j.
#'
mat_demanda_alumnos <- gen_mat_demanda_alumnos(param,param_sim)
View(mat_demanda_alumnos)


# gen_solicitudes_1_profesor ----------------------------------------------
#' Title gen_solicitudes_1_profesor: Función que genera la solicitud de 
#' un solo profesor. Arroja la matriz "mat_1_solicitud" de 4 columnas
#' (Profesor,TC,Materia, Horario) y 6 renglones que tiene la información de
#' la solicitud de "nom_prof". Se eligen 2 materias y hasta 3 diferentes
#' horarios.
#'
nom_prof<- "Arrigo Coen Coria"
tipo_prof <- 0
gen_solicitudes_1_profesor(nom_prof,tipo_prof,param)
nom_prof<- "Margarita Elvira Chávez Cano"
tipo_prof <- 1
mat_1_solicitud <- gen_solicitudes_1_profesor(nom_prof,tipo_prof,param)
View(mat_1_solicitud)


# gen_solicitudes ---------------------------------------------------------
#' Title gen_solicitudes: Función que genera la solicitud de todos los
#' profesores en la matriz "mat_nom_prof_total". Arroja la matriz
#' "mat_solicitudes" de 4 columnas (Profesor,TC,Materia, Horario). Tiene la
#' información de las solicitudes de los profesores. Se eligen hasta dos
#' materias y hasta 3 diferentes horarios. Se quitan los renglones repetidos.
#'
mat_solicitudes <- gen_solicitudes(param)#8.56 seg
View(mat_solicitudes)


# simula_alum_x_profesor --------------------------------------------------
#' Title simula_alum_x_profesor: Función que simula el número de alumnos
#' para un profesor y una materia. Se obtiene la información del número de
#' alumnos que ha tenido el profesor (del 2015-1 al 2020-1), se toma el
#' mín y el máx, se simula una uniforme en ese intervalo, se redondea el
#' valor con la función ceiling y así se obtiene el valor simulado.
#'
renglon <- c("Gerardo Sánchez Licea",1,"Análisis Matemático I",
             30,12)
(num_alum_x_profesor <- simula_alum_x_profesor(renglon,param))

# gen_D_prima -------------------------------------------------------------
#' Title gen_D_prima: Función que actualiza "D_prima". Matriz de 15x203. En
#' la entrada (i,j) se tiene el número de alumnos simulados para la hora i,
#' y la materia j.
#'
set.seed(1806)
D <- gen_mat_demanda_alumnos(param,param_sim)#39.95 seg
View(D)
set.seed(8654)
D_prima_inicial <- gen_mat_demanda_alumnos(param,param_sim)#39.95 seg
View(D_prima_inicial)
# param_sim$vec_sem_sig = 20202
# param_sim$k_sem_ant = 5
vec_s_sem_k_info <- gen_vec_s_sem_k_info(param_sim$vec_sem_sig,
                                         param_sim$k_sem_ant,param)
lista_mod_y_wait <- gen_normalmixEM_inicial(vec_s_sem_k_info,D_prima_inicial,
                                            param,param_sim)
cota <- 1000

ptm <- proc.time()# Start the clock!
D_prima <- gen_D_prima(D,D_prima_inicial,lista_mod_y_wait,cota)
cat("\nLa función gen_D_prima tardó: ",(proc.time()-ptm)[3],
    " segundos\n")##0.12
View(D_prima)

D_menosDprima <- D - D_prima
colMain <- colorRampPalette(brewer.pal(8, "Blues"))(25)
heatmap(D_menosDprima, Colv = NA, Rowv = NA, scale="none",col=colMain)

D_prima_inicial_menos_Dprima <- D_prima_inicial - D_prima
colMain <- colorRampPalette(brewer.pal(8, "Blues"))(25)
heatmap(D_prima_inicial_menos_Dprima, Colv = NA, Rowv = NA, scale="none",col=colMain)


# gen_esqueleto -----------------------------------------------------------
#' Title gen_esqueleto: Función que arroja una lista con las matrices:
#' 1) mat_esqueleto: Matriz de 15 renglones (horas) y 333 columnas
#' (materias). En la entrada (i,j) se tiene el número de grupos simulados
#' para la hora i, y la materia j.
#' 2) mat_prof_TC: Matriz de 2 columnas con el nombre de los profesores de
#' tiempo completo y el número de materias asignadas.
#' 3) mat_prof_asig: Matriz de 2 columnas con el nombre de los profesores de
#' asignatura y el número de materias asignadas.
#'
lista_info_esqueleto <- gen_esqueleto(mat_demanda_alumnos,mat_solicitudes,
                                      param)#19.48seg
View(lista_info_esqueleto[[1]])
View(lista_info_esqueleto[[2]])
View(lista_info_esqueleto[[3]])

# gen_lista_info_esqueleto ------------------------------------------------
#' Title gen_lista_info_esqueleto: Función que arroja la lista
#' "lista_info_esqueleto" con el esqueleto que será utilizado para la
#' asignación de profesores y horarios.
#' Primero se aplicael modelo de mezcla de normales al número de alumnos y
#' utilizando la función gen_esqueleto se obtiene la lista.
#'
#' @return lista_info_esqueleto: Lista con las matrices:
#' 1) mat_esqueleto: Matriz de 15 renglones (horas) y 203 columnas
#' (materias). En la entrada (i,j) se tiene el número de grupos simulados
#' para la hora i, y la materia j.
#' 2) mat_prof_TC: Matriz de 2 columnas con el nombre de los profesores de
#' tiempo completo y el número de materias asignadas.
#' 3) mat_prof_asig: Matriz de 2 columnas con el nombre de los profesores
#' de asignatura y el número de materias asignadas.
#' 4) lista_ciclo_asig: Lista 
#' 5) mat_solicitudes_TC: Matriz de solicitudes de los profesores de tiempo
#' completo.
#' 6) mat_solicitudes_asignatura: Matriz de solicitudes de los profesores
#' de asignatura.
#' 7) num_alum_simulados: Variable tipo numeric, con el número de alumnos
#' simulados totales.
#' 8) mat_E: Matriz de  15 renglones (horas) y 203 columnas (materias).
#' En la entrada (i,j) se tiene el número de alumnos simulados
#' para la hora i, y la materia j.
#' 
D_inicial <- gen_mat_demanda_alumnos(param,param_sim)#48.05 seg
mat_solicitudes <- gen_solicitudes(param)#9.15 seg
n_rep <- 10
lista_info_esqueleto <- gen_lista_info_esqueleto(D_inicial,
                                                 mat_solicitudes,
                                                 n_rep,
                                                 param)#7.98 min
mat_esqueleto <- lista_info_esqueleto[[1]]
View(mat_esqueleto)


# AG_asignaciones ---------------------------------------------------------
#' Title AG_asignaciones: Función que aplica el algoritmo genético a las
#' asignaciones para encontrar una buena asignación.
#'
#' @return list_asignacion_final: Lista de 12 elementos:
#' 1) mat_asignacion_final: Matriz de 3 columnas (Materia,Profesor,
#' Horario). Contiene la asignación final encontrada con el algoritmo
#' genético.
#' 2) calif_mejor_elem: Vector con calificaciones de los mejores elementos
#' por generación.
#' 3) mat_calif_generaciones: Matriz con calificaciones de todos los
#' elementos de todas las generaciones.
#' 4) matrices_calif_x_generacion: Lista de tamaño num_generaciones+1
#' con las matrices de calificaciones ordenadas por generación.
#' 5) mejores_asig: Lista de tamaño num_generaciones+1 con la información
#' de los mejores hijos de cada generación.
#' 6) mat_num_genes: Matriz con el número de genes de todos los elementos
#' por generación.
#' 7) mat_esqueleto
#' 8) mat_solicitudes_real
#' 9) param
#' 10) vec_info_AG: Vector con información del AG y sus resultados.
#' 11) esq_asig_final: Esqueleto de la asignación final.
#' 12) info_gpos_sin_asig: Matriz con las columnas: mat_esq (gpos. por
#' materia en mat_esqueleto), esq_asig_fin (gpos. x materia en
#' esq_asig_final), gpos_sin_asig (gpos. sin asignación x materia),
#' dif_rel (diferencia relativa x materia).

list_asignacion_final <- AG_asignaciones(mat_esqueleto,
                                         mat_solicitudes_real,
                                         param)#216.81 min

# mat_info_AG <- dat_sem_20202_g06_n05_m004_U534[[10]]
# mat_info_AG <- rbind(mat_info_AG,list_asignacion_final$mat_info_AG)
# save(mat_info_AG,file = "mat_info_AG.RData")

dat_sem_20202_g08_n08_m004_U510 <- list_asignacion_final
dat_sem_20202_g08_n08_m004_U510[[10]] <- mat_info_AG
save(dat_sem_20202_g08_n08_m004_U510,file = "dat_sem_20202_g08_n08_m004_U-510.RData")

load(file = "mat_info_AG.RData")
mat_info_AG
mat_info_AG <- rbind(mat_info_AG,list_asignacion_final$mat_info_AG)
save(mat_info_AG,file = "mat_info_AG.RData")

list_asignacion_final$mat_info_AG <- mat_info_AG
dat_sem_20202_g03_n05_m004_U655 <- list_asignacion_final
save(dat_sem_20202_g03_n05_m004_U655,file = "dat_sem_20202_g03_n05_m004_U-655.RData")



# AG_asignaciones_con_xlsx ------------------------------------------------
#' Title AG_asignaciones_con_xlsx: Función que aplica el algoritmo genético
#' a las asignaciones para encontrar una buena asignación. La función tiene
#' la opción de leer un documento de excel con asignaciones previas. En caso
#' de que si lea el documento, quita las asignaciones previas de las
#' solicitudes más la respectiva información y genera una asignación.
#'
#' @return list_asignacion_final: Lista de 12 elementos:
#' 1) mat_asignacion_final: Matriz de 3 columnas (Materia,Profesor,
#' Horario). Contiene la asignación final encontrada con el algoritmo
#' genético.
#' 2) calif_mejor_elem: Vector con calificaciones de los mejores elementos
#' por generación.
#' 3) mat_calif_generaciones: Matriz con calificaciones de todos los
#' elementos de todas las generaciones.
#' 4) matrices_calif_x_generacion: Lista de tamaño num_generaciones+1
#' con las matrices de calificaciones ordenadas por generación.
#' 5) mejores_asig: Lista de tamaño num_generaciones+1 con la información
#' de los mejores hijos de cada generación.
#' 6) mat_num_genes: Matriz con el número de genes de todos los elementos
#' por generación.
#' 7) mat_esqueleto
#' 8) mat_solicitudes_real
#' 9) param
#' 10) vec_info_AG: Vector con información del AG y sus resultados.
#' 11) esq_asig_final: Esqueleto de la asignación final.
#' 12) info_gpos_sin_asig: Matriz con las columnas: mat_esq (gpos. por
#' materia en mat_esqueleto), esq_asig_fin (gpos. x materia en
#' esq_asig_final), gpos_sin_asig (gpos. sin asignación x materia),
#' dif_rel (diferencia relativa x materia).
list_asignacion_final <- AG_asignaciones_con_xlsx(mat_esqueleto,
                                                  mat_solicitudes_real,
                                                  con_xlsx_1_sin_xlsx_0,
                                                  param)

